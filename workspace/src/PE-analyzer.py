import lief
import os

file = os.path.join("..","dataset","pe")

# バイナリのロード
binary = lief.parse(file)


# ヘッダ内のDebugSizeの取得と出力
DebugSize = binary.data_directories[6].size
print("DebugSize: {}".format(DebugSize))

# ヘッダ内のImageVersionの取得と出力
ImageVersion = binary.optional_header.major_image_version
print("ImageVersion: {}".format(ImageVersion))

# ヘッダ内のIatRVAの取得と出力
IATRVA = binary.data_directories[12].rva
print("IatRVA: {}".format(IATRVA))

# ヘッダ内のExportSizeの取得と出力
ExportSize = binary.data_directories[0].size
print("ExportSize: {}".format(ExportSize))

# ヘッダ内のResourceSizeの取得と出力
ResSize = binary.data_directories[2].size
print("ResourceSize: {}".format(ResSize))

# ヘッダ内のVirtualSize2の取得と出力
VirtualSize2 = binary.sections[1].virtual_size
print("VirtualSize2: {}".format(VirtualSize2))

# ヘッダ内のDebugRVAの取得と出力
NumberOfSections = binary.header.numberof_sections
print("NumberOfSections: {}".format(NumberOfSections))